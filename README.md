# HyperSym: An Educational MATLAB Code for Hyperelasticity

This repository contains **HyperSym**, a MATLAB-based educational tool that uses symbolic differentiation to derive stress and tangent stiffness tensors for hyperelastic materials. It is designed to support students and researchers in learning and implementing nonlinear finite element methods, and integrates directly with the NLFEA framework. This file provides a quick start, so for further information on `HyperSym`, please refer to our article in the following reference.

> üìÑ *Vinicius O. Fontes, Andr√© X. Leit√£o, Anderson Pereira*  
> **HyperSym: An Educational MATLAB Code for Hyperelasticity**  
> *Computer Applications in Engineering Education*, 2025  
> [DOI: 10.1002/cae.70037](https://doi.org/10.1002/cae.70037)

## üöÄ Features

- Symbolic derivation of second Piola‚ÄìKirchhoff stress and material tangent tensors
- Support for compressible and nearly incompressible hyperelastic models
- Automatic generation of **MATLAB** functions for integration with FE frameworks
- Seamless integration with the educational **NLFEA** code

## üì¶ Prerequisites

- **MATLAB** R2022a or later  
- **Symbolic Math Toolbox**
- A supported **C/C++ compiler** (e.g., Microsoft Visual Studio or MinGW-w64) ‚Äî required *only* for generating **MEX** files

## üõ† Usage

To use **HyperSym**, you must first download the source code, unpack the main folder `HyperSym-main`, and open it in **MATLAB**.

The example below show these steps for the nine hyperelastic presented in our article:

1. Download the source code from this reppository and extract the folder `HyperSym-main` to your working directory.
2. Open the `HyperSymScript.m` file in **MATLAB** in the `HyperSym (modified)` folder.


3. Specify the symbolic variables: deformation metrics and material parameters.

![image](https://github.com/user-attachments/assets/5b95a33e-4b12-44b4-a464-00fd49917935)

4. Define your strain energy function `W` using previously defined symbolic variables.
   - For example, line 39 shows the strain energy function for the SVK model in terms of the principal invariants of the Cauchy-Green tensor.

![image](https://github.com/user-attachments/assets/e261c0cc-8bb8-45f1-8800-98ceda7bd44a)

5. Run the script to perform symbolic differentiation and generate:
   - `Sv` ‚Äì second Piola‚ÄìKirchhoff stress tensor (Voigt vector)
   - `Dv` ‚Äì material tangent stiffness matrix (Voigt matrix)
  
  ![image](https://github.com/user-attachments/assets/699135b8-9956-4a89-99f6-e5ef62540164)
 
6. The generated functions will be saved in the `HyperSym (modified)/Functions/` directory and can be directly used in FE simulations.
   - If your call the function `Generate_mex_models`, both **MATLAB** (`.m`) and **MEX** (`.mexw64`) functions will be generated in the directory.

![image](https://github.com/user-attachments/assets/a9b3975d-4533-479e-98a8-aa8f80ef5e27)


   - If you defined a nearly incompressible hyperelastic model, isochoric (`_iso`) and volumetric (`_vol`) functions will also be created.

![image](https://github.com/user-attachments/assets/19d7c7ea-1e75-4e3b-ae35-a405bd06e6aa)

## üîó Integration with NLFEA

The scripts in the `HyperSym-main` folder are integrated with the educational finite element code, **NLFEA**. The original code for **NLFEA** is available at https://web.mae.ufl.edu/nkim/INFEM/.

When running one of the example simulations described in the next section, **NLFEA** invokes functions generated by **HyperSym**. These functions are located in the `HyperSym (modified)/Functions` directory. The preferred format for these functions is **MEX** (`_.mexw64`), provided they are available.

As a result, an `Output` folder is automatically created, where the results from the example simulations are saved.

## üìä Examples
Example problems included in this repository:

1. Cube under uniaxial traction: Compare the response of several compressible hyperelastic models in tension.

<p align="center">
  <img src="https://github.com/user-attachments/assets/2a205fd7-412b-47a7-aefc-6f6a0077756d" height="250px" />
  <img src="https://github.com/user-attachments/assets/a51462e7-6eb1-4323-a99c-325bea211c3a" height="250px" />  
</p>


2. Thin square strip: Demonstrates large deformation and sensitivity to compressibility. There are two scripts.

- `Strip.m`: Visualize the deformation using the MR model for different mesh sizes, and compare it to solutions obtained with **ANSYS**.

<p align="center">
  <img src="https://github.com/user-attachments/assets/15328a70-ee54-4d84-b497-9845af23d809" height="250px" />
  <img src="https://github.com/user-attachments/assets/eb0c90fa-cbea-49f3-a583-81451c0eb7c6" height="250px" />
</p>

- `Strip_models.m`: Compare the response of several compressible hyperelastic models for the same mesh discretization.

<p align="center">
  <img src="https://github.com/user-attachments/assets/9cfc9b40-6013-4728-ad1a-202ebe1e7e23" height="250px" />
  <img src="https://github.com/user-attachments/assets/c61c1baa-83f1-47ac-a554-f621e4df8380" height="250px" />
</p>

3. Thick-walled cylinder: Compare the deformation of a pressure vessel simulation to the results from ANSYS.

<p align="center">
  <img src="https://github.com/user-attachments/assets/19026140-a8c9-4fb0-bc5e-203449894c9d" alt="MATLAB Output 1" height="250px" />
  <img src="https://github.com/user-attachments/assets/eb2b8b6a-6f30-4cac-b839-685d54baa83e" alt="ANSYS Comparison" height="250px" />
</p>

## üìñ Citation
If you use this software in academic work, please cite:

```bibtex
@article{fontes2025hypersym,
  title   = {HyperSym: An Educational MATLAB Code for Hyperelasticity},
  author  = {Fontes, Vinicius O. and Leit√£o, Andr√© X. and Pereira, Anderson},
  journal = {Computer Applications in Engineering Education},
  year    = {2025},
  doi     = {10.1002/cae.70037}
}
```
## üèõÔ∏è Funding

Funding: This study was financed by Carlos Chagas Filho Foundation for Research Support of the State of Rio de Janeiro (FAPERJ), Process SEI 260003/008107/2022 and E‚Äê26/202.573/2022 (277082), the Coordination for the Improvement of Higher Education Personnel ‚Äì Brazil (CAPES) ‚Äì Finance Code 001, and National Council for Scientific and Technological Development ‚Äì Brazil (CNPq) (grant number 317319/2021‚Äê3).

The Article Processing Charge for the publication of this research was funded by the Coordena√ß√£o de Aperfei√ßoamento de Pessoal de N√≠vel Superior ‚Äê Brasil (CAPES) (ROR identifier: 00x0ma614).

## üôè Acknowledgemets

The authors kindly thank Professor Nam‚ÄêHo Kim for authorizing the use and modification of his finite element source code **MATLAB** code, NLFEA, and Professor Raymond Ogden for sharing the experimental data used for the curve fitting algorithm. 

## üìú Version History

- v1.0 (April 24, 2025): README added.
